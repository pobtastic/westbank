<!DOCTYPE html>
<html>
<head>
<title>West Bank: Routine at 55237</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../westbank.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="55070.html">55070</a>
</td>
<td class="up">Up: <a href="../maps/all.html#55237">Map</a></td>
<td class="next">
Next: <a href="55457.html">55457</a>
</td>
</tr>
</table>
<div class="description">55237: Bowie logic</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Handles all the logic around drawing Bowie and handling his "special" logic.
</div>
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55237"></span>
<div class="comments">
<div class="paragraph">
Bowie state variables/ flags.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Good_Bad</td>
<td class="address-2"><span id="55237"></span>55237</td>
<td class="instruction">DEFB 1</td>
<td class="comment-1" rowspan="1">If this is $00 then Bowie is "good". If this is $01 then he is "bad" (i.e. there's a bomb under his hat).</td>
</tr>
<tr>
<td class="asm-label">Bowie_Frame_Reference</td>
<td class="address-1"><span id="55238"></span>55238</td>
<td class="instruction">DEFB 34</td>
<td class="comment-1" rowspan="1">The current character frame index reference.</td>
</tr>
<tr>
<td class="asm-label">Bowie_State_Reference</td>
<td class="address-1"><span id="55239"></span>55239</td>
<td class="instruction">DEFB 6</td>
<td class="comment-1" rowspan="1">The current character state.</td>
</tr>
<tr>
<td class="asm-label">Bowie_Timer_01</td>
<td class="address-1"><span id="55240"></span>55240</td>
<td class="instruction">DEFB 0</td>
<td class="comment-1" rowspan="1">Character timer 1.</td>
</tr>
<tr>
<td class="asm-label">Bowie_Timer_02</td>
<td class="address-1"><span id="55241"></span>55241</td>
<td class="instruction">DEFB 0</td>
<td class="comment-1" rowspan="1">Character timer 2.</td>
</tr>
<tr>
<td class="asm-label">Bowie_Timer_03</td>
<td class="address-1"><span id="55242"></span>55242</td>
<td class="instruction">DEFB 0</td>
<td class="comment-1" rowspan="1">Character timer 3.</td>
</tr>
<tr>
<td class="asm-label">Bowie_Timer_04</td>
<td class="address-1"><span id="55243"></span>55243</td>
<td class="instruction">DEFB 0</td>
<td class="comment-1" rowspan="1">Character timer 4.</td>
</tr>
<tr>
<td class="asm-label">Bowie_Timer_05</td>
<td class="address-1"><span id="55244"></span>55244</td>
<td class="instruction">DEFB 0</td>
<td class="comment-1" rowspan="1">Character timer 5.</td>
</tr>
<tr>
<td class="asm-label">Bowie_Timer_06</td>
<td class="address-1"><span id="55245"></span>55245</td>
<td class="instruction">DEFB 0</td>
<td class="comment-1" rowspan="1">Character timer 6.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55246"></span>
<div class="comments">
<div class="paragraph">
This routine looks at the current character state and routes to the correct subroutine.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Routing</td>
<td class="address-2"><span id="55246"></span>55246</td>
<td class="instruction">LD HL,55239</td>
<td class="comment-1" rowspan="2"><span class="register">A</span>=<a href="55237.html#55239">Bowie_State_Reference</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55249"></span>55249</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55250"></span>55250</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="11">Work out which routine to jump to based on the current state. <table class="default">
<tr>
<th colspan="1" rowspan="1"><span class="register">A</span></th>
<th colspan="1" rowspan="1">Routine</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">1</td>
<td class="centre" colspan="1" rowspan="1"><a href="55237.html#55267">Bowie_Open_01</a></td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">2</td>
<td class="centre" colspan="1" rowspan="1"><a href="55237.html#55282">Bowie_Open_02</a></td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">3</td>
<td class="centre" colspan="1" rowspan="1"><a href="55237.html#55297">Bowie_Open_03</a></td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">4</td>
<td class="centre" colspan="1" rowspan="1"><a href="55237.html#55312">Bowie_Open_04</a></td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">5</td>
<td class="centre" colspan="1" rowspan="1"><a href="55237.html#55340">Bowie_Close_02</a></td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">6</td>
<td class="centre" colspan="1" rowspan="1"><a href="55237.html#55356">Bowie_Close_01</a></td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55251"></span>55251</td>
<td class="instruction">JR Z,<a href="55237.html#55267">Bowie_Open_01</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55253"></span>55253</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55254"></span>55254</td>
<td class="instruction">JR Z,<a href="55237.html#55282">Bowie_Open_02</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55256"></span>55256</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55257"></span>55257</td>
<td class="instruction">JR Z,<a href="55237.html#55297">Bowie_Open_03</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55259"></span>55259</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55260"></span>55260</td>
<td class="instruction">JR Z,<a href="55237.html#55312">Bowie_Open_04</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55262"></span>55262</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55263"></span>55263</td>
<td class="instruction">JR Z,<a href="55237.html#55340">Bowie_Close_02</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55265"></span>55265</td>
<td class="instruction">JR <a href="55237.html#55356">Bowie_Close_01</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55267"></span>
<div class="comments">
<div class="paragraph">
Handle door frame 1 countdown/ transition to door frame 2.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Open_01</td>
<td class="address-2"><span id="55267"></span>55267</td>
<td class="instruction">LD A,(55240)</td>
<td class="comment-1" rowspan="4">Decrease <a href="55237.html#55240">Bowie_Timer_01</a> by one, return if result is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55270"></span>55270</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55271"></span>55271</td>
<td class="instruction">LD (55240),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55274"></span>55274</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55275"></span>55275</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1">Move onto next character state.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55276"></span>55276</td>
<td class="instruction">LD A,27</td>
<td class="comment-1" rowspan="3">Pass character index <a href="40880.html">$1B</a> to <a href="54884.html#54993">Draw_DoorFrame02</a> and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55278"></span>55278</td>
<td class="instruction">CALL <a href="54884.html#54993">Draw_DoorFrame02</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55281"></span>55281</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55282"></span>
<div class="comments">
<div class="paragraph">
Handle door frame 2 countdown/ transition to door frame 3.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Open_02</td>
<td class="address-2"><span id="55282"></span>55282</td>
<td class="instruction">LD A,(55241)</td>
<td class="comment-1" rowspan="4">Decrease <a href="55237.html#55241">Bowie_Timer_02</a> by one, return if result is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55285"></span>55285</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55286"></span>55286</td>
<td class="instruction">LD (55241),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55289"></span>55289</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55290"></span>55290</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1">Move onto next character state.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55291"></span>55291</td>
<td class="instruction">LD A,27</td>
<td class="comment-1" rowspan="3">Pass character index <a href="40880.html">$1B</a> to <a href="54884.html#55007">Draw_DoorFrame03</a> and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55293"></span>55293</td>
<td class="instruction">CALL <a href="54884.html#55007">Draw_DoorFrame03</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55296"></span>55296</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55297"></span>
<div class="comments">
<div class="paragraph">
Handle door frame 3 countdown/ transition to door frame 4.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Open_03</td>
<td class="address-2"><span id="55297"></span>55297</td>
<td class="instruction">LD A,(55242)</td>
<td class="comment-1" rowspan="4">Decrease <a href="55237.html#55242">Bowie_Timer_03</a> by one, return if result is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55300"></span>55300</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55301"></span>55301</td>
<td class="instruction">LD (55242),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55304"></span>55304</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55305"></span>55305</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1">Move onto next character state.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55306"></span>55306</td>
<td class="instruction">LD A,27</td>
<td class="comment-1" rowspan="3">Pass character frame index <a href="40880.html">$1B</a> to <a href="54884.html#55021">Draw_DoorFrame04</a> and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55308"></span>55308</td>
<td class="instruction">CALL <a href="54884.html#55021">Draw_DoorFrame04</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55311"></span>55311</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55312"></span>
<div class="comments">
<div class="paragraph">
Handle door frame 4 countdown/ transition to door frame 3.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Open_04</td>
<td class="address-2"><span id="55312"></span>55312</td>
<td class="instruction">LD E,(IX+4)</td>
<td class="comment-1" rowspan="3">Call <a href="54691.html">Hit_Detection</a> with a callback to either <a href="55237.html#55371">Bowie_Cash_Action</a> or <a href="55237.html#55389">Bowie_Bomb_Action</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55315"></span>55315</td>
<td class="instruction">LD D,(IX+5)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55318"></span>55318</td>
<td class="instruction">CALL <a href="54691.html">Hit_Detection</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55321"></span>55321</td>
<td class="instruction">LD A,(55243)</td>
<td class="comment-1" rowspan="4">Decrease <a href="55237.html#55243">Bowie_Timer_04</a> by one, return if result is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55324"></span>55324</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55325"></span>55325</td>
<td class="instruction">LD (55243),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55328"></span>55328</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label">Bowie_Close_03</td>
<td class="address-2"><span id="55329"></span>55329</td>
<td class="instruction">LD HL,55239</td>
<td class="comment-1" rowspan="2">Move onto next character state (<a href="55237.html#55239">Bowie_State_Reference</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55332"></span>55332</td>
<td class="instruction">INC (HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55333"></span>55333</td>
<td class="instruction">LD A,(55238)</td>
<td class="comment-1" rowspan="3">Load the character frame index from <a href="55237.html#55238">Bowie_Frame_Reference</a>, pass it to <a href="54884.html#55007">Draw_DoorFrame03</a> and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55336"></span>55336</td>
<td class="instruction">CALL <a href="54884.html#55007">Draw_DoorFrame03</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55339"></span>55339</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55340"></span>
<div class="comments">
<div class="paragraph">
Handle door frame 3 countdown/ transition to door frame 2.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Close_02</td>
<td class="address-2"><span id="55340"></span>55340</td>
<td class="instruction">LD A,(55244)</td>
<td class="comment-1" rowspan="4">Decrease <a href="55237.html#55244">Bowie_Timer_05</a> by one, return if result is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55343"></span>55343</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55344"></span>55344</td>
<td class="instruction">LD (55244),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55347"></span>55347</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55348"></span>55348</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1">Move onto next character state.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55349"></span>55349</td>
<td class="instruction">LD A,(55238)</td>
<td class="comment-1" rowspan="3">Load the character frame index from <a href="55237.html#55238">Bowie_Frame_Reference</a>, pass it to <a href="54884.html#54993">Draw_DoorFrame02</a> and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55352"></span>55352</td>
<td class="instruction">CALL <a href="54884.html#54993">Draw_DoorFrame02</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55355"></span>55355</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55356"></span>
<div class="comments">
<div class="paragraph">
Handle door frame 2 countdown/ transition to door frame 1.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Close_01</td>
<td class="address-2"><span id="55356"></span>55356</td>
<td class="instruction">LD A,(55245)</td>
<td class="comment-1" rowspan="4">Decrease <a href="55237.html#55245">Bowie_Timer_06</a> by one, return if result is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55359"></span>55359</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55360"></span>55360</td>
<td class="instruction">LD (55245),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55363"></span>55363</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55364"></span>55364</td>
<td class="instruction">CALL <a href="54884.html">Draw_DoorFrame1</a></td>
<td class="comment-1" rowspan="1">Call <a href="54884.html">Draw_DoorFrame1</a> (i.e. no character/ door is shut).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55367"></span>55367</td>
<td class="instruction">CALL <a href="55457.html">Reset___</a></td>
<td class="comment-1" rowspan="1">Call <a href="55457.html">Reset___</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55370"></span>55370</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55371"></span>
<div class="comments">
<div class="paragraph">
Handles marking this as something shootable.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Cash_Action</td>
<td class="address-1"><span id="55371"></span>55371</td>
<td class="instruction">LD (IX+6),5</td>
<td class="comment-1" rowspan="2">Writes $05 to <span class="register">IX</span>+$06 and $01 to <span class="register">IX</span>+$07.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55375"></span>55375</td>
<td class="instruction">LD (IX+7),1</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55379"></span>55379</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="3">Writes $01 to <span class="register">IX</span>+$08 and <a href="53648.html">53648</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55381"></span>55381</td>
<td class="instruction">LD (IX+8),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55384"></span>55384</td>
<td class="instruction">LD (53648),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55387"></span>55387</td>
<td class="instruction">JR <a href="55237.html#55329">Bowie_Close_03</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="55237.html#55329">Bowie_Close_03</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55389"></span>
<div class="comments">
<div class="paragraph">
Handles marking this as something unshootable.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Bomb_Action</td>
<td class="address-1"><span id="55389"></span>55389</td>
<td class="instruction">LD A,5</td>
<td class="comment-1" rowspan="3">Writes $05 to <a href="53977.html#54014">54014</a> and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55391"></span>55391</td>
<td class="instruction">LD (54014),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55394"></span>55394</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55395"></span>
<div class="comments">
<div class="paragraph">
Handles both shooting the hats off Bowie's head, and checking/ routing on the last frame for the "surprise".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Shot_Action</td>
<td class="address-1"><span id="55395"></span>55395</td>
<td class="instruction">LD HL,55238</td>
<td class="comment-1" rowspan="2"><span class="register">A</span>=<a href="55237.html#55238">Bowie_Frame_Reference</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55398"></span>55398</td>
<td class="instruction">LD A,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55399"></span>55399</td>
<td class="instruction">CP 33</td>
<td class="comment-1" rowspan="1">Is it character frame reference (<a href="40880.html#44048">1 hat | 33</a>)?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55401"></span>55401</td>
<td class="instruction">LD (IX+6),1</td>
<td class="comment-1" rowspan="1">Writes $01 to <span class="register">IX</span>+$06.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55405"></span>55405</td>
<td class="instruction">JR NC,<a href="55237.html#55413">Bowie_Check</a></td>
<td class="comment-1" rowspan="1">If Bowie is on the last frame then jump forward to <a href="55237.html#55413">Bowie_Check</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55407"></span>55407</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="4">Else update <a href="55237.html#55238">Bowie_Frame_Reference</a> to point at the next frame, call <a href="54884.html#55021">Draw_DoorFrame04</a> and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55408"></span>55408</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55409"></span>55409</td>
<td class="instruction">CALL <a href="54884.html#55021">Draw_DoorFrame04</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55412"></span>55412</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55413"></span>
<div class="comments">
<div class="paragraph">
Checks the "good/ bad" flag and routes the gameplay accordingly.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_Check</td>
<td class="address-2"><span id="55413"></span>55413</td>
<td class="instruction">LD A,(55237)</td>
<td class="comment-1" rowspan="3">If <a href="55237.html">Bowie_Good_Bad</a> is zero jump to <a href="55237.html#55421">Bowie_State_Cash</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55416"></span>55416</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55417"></span>55417</td>
<td class="instruction">JR Z,<a href="55237.html#55421">Bowie_State_Cash</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55419"></span>55419</td>
<td class="instruction">JR <a href="55237.html#55439">Bowie_State_Bomb</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="55237.html#55439">Bowie_State_Bomb</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55421"></span>
<div class="comments">
<div class="paragraph">
Handle displaying cash character frame.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_State_Cash</td>
<td class="address-2"><span id="55421"></span>55421</td>
<td class="instruction">LD A,35</td>
<td class="comment-1" rowspan="3">Writes character frame reference <a href="40880.html#45104">cash | 35</a> to <a href="55237.html#55238">Bowie_Frame_Reference</a>, and pass it to <a href="54884.html#55021">Draw_DoorFrame04</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55423"></span>55423</td>
<td class="instruction">LD (55238),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55426"></span>55426</td>
<td class="instruction">CALL <a href="54884.html#55021">Draw_DoorFrame04</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55429"></span>55429</td>
<td class="instruction">LD HL,55371</td>
<td class="comment-1" rowspan="3">Writes <a href="55237.html#55371">Bowie_Cash_Action</a> to the current door flags (e.g. <a href="53605.html#53609">Door_Bowie_Action_01</a>, <a href="53619.html#53623">Door_Bowie_Action_02</a> or <a href="53633.html#53637">Door_Bowie_Action_03</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55432"></span>55432</td>
<td class="instruction">LD (IX+4),L</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55435"></span>55435</td>
<td class="instruction">LD (IX+5),H</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55438"></span>55438</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="55439"></span>
<div class="comments">
<div class="paragraph">
Handle displaying bomb character frame.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Bowie_State_Bomb</td>
<td class="address-2"><span id="55439"></span>55439</td>
<td class="instruction">LD A,34</td>
<td class="comment-1" rowspan="3">Writes character frame reference <a href="40880.html#44576">bomb | 34</a> to <a href="55237.html#55238">Bowie_Frame_Reference</a>, and pass it to <a href="54884.html#55021">Draw_DoorFrame04</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55441"></span>55441</td>
<td class="instruction">LD (55238),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55444"></span>55444</td>
<td class="instruction">CALL <a href="54884.html#55021">Draw_DoorFrame04</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55447"></span>55447</td>
<td class="instruction">LD HL,55389</td>
<td class="comment-1" rowspan="3">Writes <a href="55237.html#55389">Bowie_Bomb_Action</a> to the current door flags (e.g. <a href="53605.html#53609">Door_Bowie_Action_01</a>, <a href="53619.html#53623">Door_Bowie_Action_02</a> or <a href="53633.html#53637">Door_Bowie_Action_03</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55450"></span>55450</td>
<td class="instruction">LD (IX+4),L</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55453"></span>55453</td>
<td class="instruction">LD (IX+5),H</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="55456"></span>55456</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="55070.html">55070</a>
</td>
<td class="up">Up: <a href="../maps/all.html#55237">Map</a></td>
<td class="next">
Next: <a href="55457.html">55457</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; DINAMIC SOFTWARE 1985 &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.8.</div>
<div><a href="../../asm/D7C5.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>