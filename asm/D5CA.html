<!DOCTYPE html>
<html>
<head>
<title>West Bank: Routine at D5CA</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../westbank.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="D5B0.html">D5B0</a>
</td>
<td class="up">Up: <a href="../maps/all.html#d5ca">Map</a></td>
<td class="next">
Next: <a href="D5E6.html">D5E6</a>
</td>
</tr>
</table>
<div class="description">D5CA: Draw Character In Doorway</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Draws the character frame at the location of one of the three (open) doors. This is direct function, hence is only used when the door is open (it doesn't utilise the door buffer).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Draw_CharacterInDoorway</td>
<td class="address-2"><span id="d5ca"></span>D5CA</td>
<td class="instruction">CALL <a href="D5B0.html">Character_Address</a></td>
<td class="comment-1" rowspan="1">Retrieve the memory location for the character frame from the passed index in <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5cd"></span>D5CD</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5ce"></span>D5CE</td>
<td class="instruction">LD B,$58</td>
<td class="comment-1" rowspan="2">Sets the height and width.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5d0"></span>D5D0</td>
<td class="instruction">LD C,$06</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5d2"></span>D5D2</td>
<td class="instruction">LD A,($CE1A)</td>
<td class="comment-1" rowspan="1">Retrieves the currently in-focus door from <a href="CE1A.html">Door_Frame_Reference</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5d5"></span>D5D5</td>
<td class="instruction">LD HL,$4082</td>
<td class="comment-1" rowspan="8">Work out which screen position to use for the currently focused door; <table class="default">
<tr>
<th colspan="1" rowspan="1"><span class="register">A</span></th>
<th colspan="1" rowspan="1">Screen Address</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">01</td>
<td class="" colspan="1" rowspan="1">$4082</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">02</td>
<td class="" colspan="1" rowspan="1">$408D</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">03</td>
<td class="" colspan="1" rowspan="1">$4098</td>
</tr>
</table> Jump to <a href="D5E6.html">Copy_Routine</a> to draw the character and handle the return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5d8"></span>D5D8</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5d9"></span>D5D9</td>
<td class="instruction">JR Z,<a href="D5E6.html">Copy_Routine</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5db"></span>D5DB</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5dc"></span>D5DC</td>
<td class="instruction">LD HL,$408D</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5df"></span>D5DF</td>
<td class="instruction">JR Z,<a href="D5E6.html">Copy_Routine</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5e1"></span>D5E1</td>
<td class="instruction">LD HL,$4098</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d5e4"></span>D5E4</td>
<td class="instruction">JR <a href="D5E6.html">Copy_Routine</a></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="D5B0.html">D5B0</a>
</td>
<td class="up">Up: <a href="../maps/all.html#d5ca">Map</a></td>
<td class="next">
Next: <a href="D5E6.html">D5E6</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; DINAMIC SOFTWARE 1985 &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
<div><a href="../dec/asm/54730.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>