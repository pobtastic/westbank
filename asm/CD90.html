<!DOCTYPE html>
<html>
<head>
<title>West Bank: Routine at CD90</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../westbank.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="CD8D.html">CD8D</a>
</td>
<td class="up">Up: <a href="../maps/all.html#cd90">Map</a></td>
<td class="next">
Next: <a href="CDAE.html">CDAE</a>
</td>
</tr>
</table>
<div class="description">CD90: Draw Score To The Screen</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="5B98.html">Draw_Score_Alias</a>, <a href="C9B7.html">Prep_Display_Phase</a> and <a href="CDC3.html">Scoring</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Draw_Score</td>
<td class="address-2"><span id="cd90"></span>CD90</td>
<td class="instruction">LD HL,$CD8B</td>
<td class="comment-1" rowspan="3">Starting values; <table class="default">
<tr>
<th colspan="1" rowspan="1">Source</th>
<th colspan="1" rowspan="1">Screen Buffer</th>
<th colspan="1" rowspan="1">Counter</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="CD86.html#cd8b">Scoredigit01</a></td>
<td class="centre" colspan="1" rowspan="1">$50C8</td>
<td class="centre" colspan="1" rowspan="1">06</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd93"></span>CD93</td>
<td class="instruction">LD DE,$50C8</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd96"></span>CD96</td>
<td class="instruction">LD B,$06</td>
</tr>
<tr>
<td class="asm-label">Scoredigit_Loop</td>
<td class="address-2"><span id="cd98"></span>CD98</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="3">Stash the lot.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd99"></span>CD99</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd9a"></span>CD9A</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd9b"></span>CD9B</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="6">Grab the number at the source memory location; <ul class="">
<li>If it's zero then add $0A (as the numbers are stored 1-2-3-4-5-6-7-8-9-0 whereas ASCII uses 0-1-2-3-4-5-6-7-8-9)</li>
<li>add $23 (so for example "2" will be "$25" - see <a href="CDAE.html">Draw_Number</a>)</li>
<li>Call <a href="CDAE.html">Draw_Number</a></li>
</ul></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd9c"></span>CD9C</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd9d"></span>CD9D</td>
<td class="instruction">JR NZ,<a href="CD90.html#cda1">Scoredigit_Non_Zero</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cd9f"></span>CD9F</td>
<td class="instruction">ADD A,$0A</td>
</tr>
<tr>
<td class="asm-label">Scoredigit_Non_Zero</td>
<td class="address-2"><span id="cda1"></span>CDA1</td>
<td class="instruction">ADD A,$23</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cda3"></span>CDA3</td>
<td class="instruction">CALL <a href="CDAE.html">Draw_Number</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cda6"></span>CDA6</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="3">Retrieve our current source, destination and counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cda7"></span>CDA7</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cda8"></span>CDA8</td>
<td class="instruction">POP BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cda9"></span>CDA9</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="3">Increase the screen buffer memory location by one, decrease the source memory location and loop round to <a href="CD90.html#cd98">Scoredigit_Loop</a> until it is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cdaa"></span>CDAA</td>
<td class="instruction">DEC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cdab"></span>CDAB</td>
<td class="instruction">DJNZ <a href="CD90.html#cd98">Scoredigit_Loop</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cdad"></span>CDAD</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="CD8D.html">CD8D</a>
</td>
<td class="up">Up: <a href="../maps/all.html#cd90">Map</a></td>
<td class="next">
Next: <a href="CDAE.html">CDAE</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; DINAMIC SOFTWARE 1985 &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
<div><a href="../dec/asm/52624.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>