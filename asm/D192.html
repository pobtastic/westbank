<!DOCTYPE html>
<html>
<head>
<title>West Bank: Routine at D192</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../westbank.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="D191.html">D191</a>
</td>
<td class="up">Up: <a href="../maps/all.html#d192">Map</a></td>
<td class="next">
Next: <a href="D2CF.html">D2CF</a>
</td>
</tr>
</table>
<div class="description">D192: Copy Source Character Data To Character State Data</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d192"></span>
<div class="comments">
<div class="paragraph">
Handles copying a "normal" bandit into the bandit state cache at <a href="D71E.html">Bandit_State_Reference</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Bandit_Open</td>
<td class="address-2"><span id="d192"></span>D192</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $0007 bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="D71E.html">Bandit_State_Reference</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d195"></span>D195</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d198"></span>D198</td>
<td class="instruction">LD DE,$D71E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d19b"></span>D19B</td>
<td class="instruction">LD BC,$0007</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d19e"></span>D19E</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d19f"></span>D19F</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1a0"></span>D1A0</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1a1"></span>D1A1</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1a3"></span>D1A3</td>
<td class="instruction">CALL <a href="D71E.html#d725">Bandit_Open_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="D71E.html#d725">Bandit_Open_Routing</a> to begin this characters actions.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1a6"></span>D1A6</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1a7"></span>D1A7</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1a8"></span>D1A8</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1a9"></span>D1A9</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Swap the source and target.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1aa"></span>D1AA</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="5">Check if <a href="D18F.html">D18F</a> is zero. Write $00 to it. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1ad"></span>D1AD</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1ae"></span>D1AE</td>
<td class="instruction">LD A,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1b0"></span>D1B0</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1b3"></span>D1B3</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1b4"></span>D1B4</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Else copy the (swapped) source back to the new target and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1b6"></span>D1B6</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d1b7"></span>
<div class="comments">
<div class="paragraph">
And copying a successful bandit encounter to close the door.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Bandit_Close</td>
<td class="address-1"><span id="d1b7"></span>D1B7</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $0007 bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="D71E.html">Bandit_State_Reference</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1ba"></span>D1BA</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1bd"></span>D1BD</td>
<td class="instruction">LD DE,$D71E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1c0"></span>D1C0</td>
<td class="instruction">LD BC,$0007</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1c3"></span>D1C3</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1c4"></span>D1C4</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1c5"></span>D1C5</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1c6"></span>D1C6</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1c8"></span>D1C8</td>
<td class="instruction">CALL <a href="D71E.html#d771">Bandit_Close_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="D71E.html#d771">Bandit_Close_Routing</a> to begin this characters actions.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1cb"></span>D1CB</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1cc"></span>D1CC</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1cd"></span>D1CD</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1ce"></span>D1CE</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Swap the source and target.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1cf"></span>D1CF</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="5">Check if <a href="D18F.html">D18F</a> is zero. Write $00 to it. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1d2"></span>D1D2</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1d3"></span>D1D3</td>
<td class="instruction">LD A,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1d5"></span>D1D5</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1d8"></span>D1D8</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1d9"></span>D1D9</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Else copy the (swapped) source back to the new target and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1db"></span>D1DB</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d1dc"></span>
<div class="comments">
<div class="paragraph">
Handles copying Bowie state data into the state cache at <a href="D7C5.html">Bowie_Good_Bad</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Bowie</td>
<td class="address-1"><span id="d1dc"></span>D1DC</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $0009 bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="D7C5.html">Bowie_Good_Bad</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1df"></span>D1DF</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1e2"></span>D1E2</td>
<td class="instruction">LD DE,$D7C5</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1e5"></span>D1E5</td>
<td class="instruction">LD BC,$0009</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1e8"></span>D1E8</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1e9"></span>D1E9</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1ea"></span>D1EA</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1eb"></span>D1EB</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1ed"></span>D1ED</td>
<td class="instruction">CALL <a href="D7C5.html#d7ce">Bowie_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="D7C5.html#d7ce">Bowie_Routing</a> to begin this characters actions.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1f0"></span>D1F0</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1f1"></span>D1F1</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1f2"></span>D1F2</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1f3"></span>D1F3</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Swap the source and target.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1f4"></span>D1F4</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="5">Check if <a href="D18F.html">D18F</a> is zero. Write $00 to it. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1f7"></span>D1F7</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1f8"></span>D1F8</td>
<td class="instruction">LD A,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1fa"></span>D1FA</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1fd"></span>D1FD</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d1fe"></span>D1FE</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Else copy the (swapped) source back to the new target and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d200"></span>D200</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d201"></span>
<div class="comments">
<div class="paragraph">
Handles copying customer state data into the state cache at <a href="D48F.html">Customer_Frame_01</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Customer</td>
<td class="address-1"><span id="d201"></span>D201</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $000F bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="D48F.html">Customer_Frame_01</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d204"></span>D204</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d207"></span>D207</td>
<td class="instruction">LD DE,$D48F</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d20a"></span>D20A</td>
<td class="instruction">LD BC,$000F</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d20d"></span>D20D</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d20e"></span>D20E</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d20f"></span>D20F</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d210"></span>D210</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d212"></span>D212</td>
<td class="instruction">CALL <a href="D48F.html#d49e">Customer_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="D48F.html#d49e">Customer_Routing</a> to begin this characters actions.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d215"></span>D215</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d216"></span>D216</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d217"></span>D217</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d218"></span>D218</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Swap the source and target.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d219"></span>D219</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="5">Check if <a href="D18F.html">D18F</a> is zero. Write $00 to it. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d21c"></span>D21C</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d21d"></span>D21D</td>
<td class="instruction">LD A,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d21f"></span>D21F</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d222"></span>D222</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d223"></span>D223</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Else copy the (swapped) source back to the new target and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d225"></span>D225</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d226"></span>
<div class="comments">
<div class="paragraph">
Handles copying customer "is shot" state data into the state cache at <a href="D48F.html">Customer_Frame_01</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Customer_Shot</td>
<td class="address-1"><span id="d226"></span>D226</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $000F bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="D48F.html">Customer_Frame_01</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d229"></span>D229</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d22c"></span>D22C</td>
<td class="instruction">LD DE,$D48F</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d22f"></span>D22F</td>
<td class="instruction">LD BC,$000F</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d232"></span>D232</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d233"></span>D233</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d234"></span>D234</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d235"></span>D235</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d237"></span>D237</td>
<td class="instruction">CALL <a href="D48F.html#d57b">Customer_Shot</a></td>
<td class="comment-1" rowspan="1">Call <a href="D48F.html#d57b">Customer_Shot</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d23a"></span>D23A</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d23b"></span>D23B</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d23c"></span>D23C</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d23d"></span>D23D</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Swap the source and target.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d23e"></span>D23E</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Copy the (swapped) source back to the new target and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d240"></span>D240</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d241"></span>
<div class="comments">
<div class="paragraph">
Handles copying Julius state data into the state cache at <a href="D8E5.html">Julius_Good_Bad</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Julius_Open</td>
<td class="address-1"><span id="d241"></span>D241</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $000A bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="D8E5.html">Julius_Good_Bad</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d244"></span>D244</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d247"></span>D247</td>
<td class="instruction">LD DE,$D8E5</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d24a"></span>D24A</td>
<td class="instruction">LD BC,$000A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d24d"></span>D24D</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d24e"></span>D24E</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d24f"></span>D24F</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d250"></span>D250</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d252"></span>D252</td>
<td class="instruction">CALL <a href="D8E5.html#d8ef">Julius_Open_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="D8E5.html#d8ef">Julius_Open_Routing</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d255"></span>D255</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d256"></span>D256</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d257"></span>D257</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d258"></span>D258</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="5">Check if <a href="D18F.html">D18F</a> is zero. Write $00 to it. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d25b"></span>D25B</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d25c"></span>D25C</td>
<td class="instruction">LD A,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d25e"></span>D25E</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d261"></span>D261</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d262"></span>D262</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Copy the source to the target again and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d264"></span>D264</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d265"></span>
<div class="comments">
<div class="paragraph">
And copying a successful Julius encounter to close the door.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Julius_Close</td>
<td class="address-1"><span id="d265"></span>D265</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $000A bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="D8E5.html">Julius_Good_Bad</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d268"></span>D268</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d26b"></span>D26B</td>
<td class="instruction">LD DE,$D8E5</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d26e"></span>D26E</td>
<td class="instruction">LD BC,$000A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d271"></span>D271</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d272"></span>D272</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d273"></span>D273</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d274"></span>D274</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d276"></span>D276</td>
<td class="instruction">CALL <a href="D8E5.html#d997">Julius_Close_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="D8E5.html#d997">Julius_Close_Routing</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d279"></span>D279</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d27a"></span>D27A</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d27b"></span>D27B</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d27c"></span>D27C</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="5">Check if <a href="D18F.html">D18F</a> is zero. Write $00 to it. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d27f"></span>D27F</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d280"></span>D280</td>
<td class="instruction">LD A,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d282"></span>D282</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d285"></span>D285</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d286"></span>D286</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Copy the source to the target again and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d288"></span>D288</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d289"></span>
<div class="comments">
<div class="paragraph">
Handles copying a "drawing bandit" into the bandit state cache at <a href="DA0C.html">Bandit_Draw</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Bandit_Draw_Open</td>
<td class="address-1"><span id="d289"></span>D289</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $000B bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="DA0C.html">Bandit_Draw</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d28c"></span>D28C</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d28f"></span>D28F</td>
<td class="instruction">LD DE,$DA0C</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d292"></span>D292</td>
<td class="instruction">LD BC,$000B</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d295"></span>D295</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d296"></span>D296</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d297"></span>D297</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d298"></span>D298</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d29a"></span>D29A</td>
<td class="instruction">CALL <a href="DA0C.html#da17">Bandit_Draw_Open_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="DA0C.html#da17">Bandit_Draw_Open_Routing</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d29d"></span>D29D</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d29e"></span>D29E</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d29f"></span>D29F</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2a0"></span>D2A0</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="5">Check if <a href="D18F.html">D18F</a> is zero. Write $00 to it. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2a3"></span>D2A3</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2a4"></span>D2A4</td>
<td class="instruction">LD A,$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2a6"></span>D2A6</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2a9"></span>D2A9</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2aa"></span>D2AA</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Copy the source to the target again and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2ac"></span>D2AC</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="d2ad"></span>
<div class="comments">
<div class="paragraph">
And copying a successful "drawing bandit" encounter to close the door.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Bandit_Draw_Close</td>
<td class="address-1"><span id="d2ad"></span>D2AD</td>
<td class="instruction">LD L,(IX+$02)</td>
<td class="comment-1" rowspan="8">Handles copying $000B bytes of data from the address contained at (depending on which door is currently being actioned); <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Door</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D165.html#d167">Door_Source_01</a></td>
<td class="centre" colspan="1" rowspan="1">Door 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D173.html#d175">Door_Source_02</a></td>
<td class="centre" colspan="1" rowspan="1">Door 2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="D181.html#d183">Door_Source_03</a></td>
<td class="centre" colspan="1" rowspan="1">Door 3</td>
</tr>
</table> to <a href="DA0C.html">Bandit_Draw</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2b0"></span>D2B0</td>
<td class="instruction">LD H,(IX+$03)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2b3"></span>D2B3</td>
<td class="instruction">LD DE,$DA0C</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2b6"></span>D2B6</td>
<td class="instruction">LD BC,$000B</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2b9"></span>D2B9</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2ba"></span>D2BA</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2bb"></span>D2BB</td>
<td class="instruction">PUSH BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2bc"></span>D2BC</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2be"></span>D2BE</td>
<td class="instruction">CALL <a href="DA0C.html#da85">Bandit_Draw_Close_Routing</a></td>
<td class="comment-1" rowspan="1">Call <a href="DA0C.html#da85">Bandit_Draw_Close_Routing</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2c1"></span>D2C1</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="3">Restore the source, target and counter from above.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2c2"></span>D2C2</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2c3"></span>D2C3</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2c4"></span>D2C4</td>
<td class="instruction">LD A,($D18F)</td>
<td class="comment-1" rowspan="4">Check if <a href="D18F.html">D18F</a> is zero. If it wasn't zero then return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2c7"></span>D2C7</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2c8"></span>D2C8</td>
<td class="instruction">LD ($D18F),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2cb"></span>D2CB</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2cc"></span>D2CC</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="2">Copy the source to the target again and return.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="d2ce"></span>D2CE</td>
<td class="instruction">RET</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="D191.html">D191</a>
</td>
<td class="up">Up: <a href="../maps/all.html#d192">Map</a></td>
<td class="next">
Next: <a href="D2CF.html">D2CF</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; DINAMIC SOFTWARE 1985 &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
<div><a href="../dec/asm/53650.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>