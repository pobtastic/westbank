<!DOCTYPE html>
<html>
<head>
<title>West Bank: Routine at C9B7</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../westbank.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="C959.html">C959</a>
</td>
<td class="up">Up: <a href="../maps/all.html#c9b7">Map</a></td>
<td class="next">
Next: <a href="CAE7.html">CAE7</a>
</td>
</tr>
</table>
<div class="description">C9B7: Prepare To Display The Current Phase</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="c9b7"></span>
<div class="comments">
<div class="paragraph">
Clears the cashbox flags, clears the screen and displays the phase number.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Display_Phase</td>
<td class="address-2"><span id="c9b7"></span>C9B7</td>
<td class="instruction">LD HL,$0101</td>
<td class="comment-1" rowspan="2">Writes $01 to both <a href="D45C.html">CashboxReference_Inactive</a> and <a href="D45C.html#d45d">CashboxReference_Active</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9ba"></span>C9BA</td>
<td class="instruction">LD ($D45C),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9bd"></span>C9BD</td>
<td class="instruction">LD HL,$CC8D</td>
<td class="comment-1" rowspan="5">Clear down the deposit flags (copies $00 to each from <a href="CC8D.html">DoorDeposited_01</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9c0"></span>C9C0</td>
<td class="instruction">LD DE,$CC8E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9c3"></span>C9C3</td>
<td class="instruction">LD BC,$000D</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9c6"></span>C9C6</td>
<td class="instruction">LD (HL),$00</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9c8"></span>C9C8</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9ca"></span>C9CA</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="2">Call <a href="C9B7.html#c9d0">Clear_Screen</a> (using $00).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9cb"></span>C9CB</td>
<td class="instruction">CALL <a href="C9B7.html#c9d0">Clear_Screen</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9ce"></span>C9CE</td>
<td class="instruction">JR <a href="C9B7.html#c9dd">Display_Phase</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="C9B7.html#c9dd">Display_Phase</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="c9d0"></span>
<div class="comments">
<div class="paragraph">
This routine has the ability to write any value across the screen buffer, however it's only ever called with <span class="register">A</span>=$00 (clear screen).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Clear_Screen</td>
<td class="address-2"><span id="c9d0"></span>C9D0</td>
<td class="instruction">LD HL,$4000</td>
<td class="comment-1" rowspan="6">Clears the screen buffer by writing $00 to all 6912 memory locations.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9d3"></span>C9D3</td>
<td class="instruction">LD DE,$4001</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9d6"></span>C9D6</td>
<td class="instruction">LD BC,$1AFF</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9d9"></span>C9D9</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9da"></span>C9DA</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9dc"></span>C9DC</td>
<td class="instruction">RET</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="c9dd"></span>
<div class="comments">
<div class="paragraph">
Displays the current "phase".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Display_Phase</td>
<td class="address-2"><span id="c9dd"></span>C9DD</td>
<td class="instruction">LD HL,$CA4E</td>
<td class="comment-1" rowspan="4">Copies <a href="C9B7.html#ca4e">Phase_Copy</a> into <a href="C9B7.html#ca5c">Progress_Buffer</a> ($05 bytes of text data).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9e0"></span>C9E0</td>
<td class="instruction">LD DE,$CA5C</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9e3"></span>C9E3</td>
<td class="instruction">LD BC,$0005</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9e6"></span>C9E6</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9e8"></span>C9E8</td>
<td class="instruction">LD HL,($CA5A)</td>
<td class="comment-1" rowspan="2">Writes <a href="C9B7.html#ca5a">Phase_ASCII</a> to <a href="C9B7.html#ca5c">Progress_Buffer</a> (at $CA61 - just overwriting the numeric part).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9eb"></span>C9EB</td>
<td class="instruction">LD ($CA61),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9ee"></span>C9EE</td>
<td class="instruction">LD HL,$CA4A</td>
<td class="comment-1" rowspan="2">Call <a href="C9B7.html#ca19">Progress_Base_10</a> with <a href="C9B7.html#ca4a">Phase</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9f1"></span>C9F1</td>
<td class="instruction">CALL <a href="C9B7.html#ca19">Progress_Base_10</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9f4"></span>C9F4</td>
<td class="instruction">LD HL,($CA61)</td>
<td class="comment-1" rowspan="2">Writes $CA61 back to <a href="C9B7.html#ca5a">Phase_ASCII</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9f7"></span>C9F7</td>
<td class="instruction">LD ($CA5A),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9fa"></span>C9FA</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="c9fb"></span>
<div class="comments">
<div class="paragraph">
Displays the current "day".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Display_Day</td>
<td class="address-2"><span id="c9fb"></span>C9FB</td>
<td class="instruction">LD HL,$CA53</td>
<td class="comment-1" rowspan="4">Copies <a href="C9B7.html#ca53">Day_Copy</a> into <a href="C9B7.html#ca5c">Progress_Buffer</a> ($05 bytes of text data).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="c9fe"></span>C9FE</td>
<td class="instruction">LD DE,$CA5C</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca01"></span>CA01</td>
<td class="instruction">LD BC,$0005</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca04"></span>CA04</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca06"></span>CA06</td>
<td class="instruction">LD HL,($CA58)</td>
<td class="comment-1" rowspan="2">Writes <a href="C9B7.html#ca58">Day_ASCII</a> to <a href="C9B7.html#ca5c">Progress_Buffer</a> (at $CA61 - just overwriting the numeric part).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca09"></span>CA09</td>
<td class="instruction">LD ($CA61),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca0c"></span>CA0C</td>
<td class="instruction">LD HL,$CA4C</td>
<td class="comment-1" rowspan="2">Call <a href="C9B7.html#ca19">Progress_Base_10</a> with <a href="C9B7.html#ca4c">Day</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca0f"></span>CA0F</td>
<td class="instruction">CALL <a href="C9B7.html#ca19">Progress_Base_10</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca12"></span>CA12</td>
<td class="instruction">LD HL,($CA61)</td>
<td class="comment-1" rowspan="2">Writes $CA61 back to <a href="C9B7.html#ca58">Day_ASCII</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca15"></span>CA15</td>
<td class="instruction">LD ($CA58),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca18"></span>CA18</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ca19"></span>
<div class="comments">
<div class="paragraph">
This routine is for converting progress numbers into ASCII. On entry <span class="register">HL</span> will be either <a href="C9B7.html#ca4a">Phase</a> or <a href="C9B7.html#ca4c">Day</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Progress_Base_10</td>
<td class="address-2"><span id="ca19"></span>CA19</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="4">If the passed number is not more than 10 jump to <a href="C9B7.html#ca27">Progress_Divisible_10</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca1a"></span>CA1A</td>
<td class="instruction">INC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca1b"></span>CA1B</td>
<td class="instruction">CP $0A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca1d"></span>CA1D</td>
<td class="instruction">JR NC,<a href="C9B7.html#ca27">Progress_Divisible_10</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca1f"></span>CA1F</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="3">Stores the ASCII representation of the number at $CA62 (for <a href="C9B7.html#ca5c">Progress_Buffer</a>). It adds ASCII "0" so for example 1 ends up being 1 + $30 = $31 (e.g. "1" in ASCII).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca20"></span>CA20</td>
<td class="instruction">ADD A,$30</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca22"></span>CA22</td>
<td class="instruction">LD ($CA62),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca25"></span>CA25</td>
<td class="instruction">JR <a href="C9B7.html#ca38">Print_Progress</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="C9B7.html#ca38">Print_Progress</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ca27"></span>
<div class="comments">
<div class="paragraph">
Ensures the progress digit remains 0-9. On entry <span class="register">HL</span> will be either <a href="C9B7.html#ca4a">Phase</a> or <a href="C9B7.html#ca4c">Day</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Progress_Divisible_10</td>
<td class="address-2"><span id="ca27"></span>CA27</td>
<td class="instruction">LD (HL),$00</td>
<td class="comment-1" rowspan="1">Reset the current progress digit to $00.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca29"></span>CA29</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Use the secondary digit of the currently focused progress.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ca2a"></span>
<div class="comments">
<div class="paragraph">
Note this doesn't account for a third digit and so leads to eventual corruption. Once past day/ phase "99", this will display "00" and past "09" the first ASCII digit doesn't point to any usable image data. Note however, this occurs after ~4 hours of game play so isn't especially an issue.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca2a"></span>CA2A</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1">Increase this second digit by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca2b"></span>CA2B</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="3">Add ASCII "0" so for example 1 ends up being 1 + $30 = $31 (e.g. "1" in ASCII). Write this number to $CA61 (for <a href="C9B7.html#ca5c">Progress_Buffer</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca2c"></span>CA2C</td>
<td class="instruction">ADD A,$30</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca2e"></span>CA2E</td>
<td class="instruction">LD ($CA61),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca31"></span>CA31</td>
<td class="instruction">DEC HL</td>
<td class="comment-1" rowspan="1">Move back to point to the original location of <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca32"></span>CA32</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="3">Again, add ASCII "0" for this digit too. Write this number to $CA62 (for <a href="C9B7.html#ca5c">Progress_Buffer</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca33"></span>CA33</td>
<td class="instruction">ADD A,$30</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca35"></span>CA35</td>
<td class="instruction">LD ($CA62),A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ca38"></span>
<div class="comments">
<div class="paragraph">
Prints the current progress buffer message to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Print_Progress</td>
<td class="address-2"><span id="ca38"></span>CA38</td>
<td class="instruction">LD HL,$CA5C</td>
<td class="comment-1" rowspan="4">Prints <a href="C9B7.html#ca5c">Progress_Buffer</a> to the screen buffer at $486C using <a href="CBD0.html#cbd2">Print_TwoToneText</a>. <table class="default">
<tr>
<th colspan="1" rowspan="1">Value</th>
<th colspan="1" rowspan="1">Ink</th>
<th colspan="1" rowspan="1">Paper</th>
<th colspan="1" rowspan="1">Bright</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">07</td>
<td class="centre" colspan="1" rowspan="1">07</td>
<td class="centre" colspan="1" rowspan="1">00</td>
<td class="centre" colspan="1" rowspan="1">00</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">03</td>
<td class="centre" colspan="1" rowspan="1">03</td>
<td class="centre" colspan="1" rowspan="1">00</td>
<td class="centre" colspan="1" rowspan="1">00</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca3b"></span>CA3B</td>
<td class="instruction">LD DE,$486C</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca3e"></span>CA3E</td>
<td class="instruction">LD BC,$0703</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca41"></span>CA41</td>
<td class="instruction">CALL <a href="CBD0.html#cbd2">Print_TwoToneText</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca44"></span>CA44</td>
<td class="instruction">LD B,$50</td>
<td class="comment-1" rowspan="3">Interrupt driven HALT loop ($50 cycles).</td>
</tr>
<tr>
<td class="asm-label">Progress_Halt_Loop</td>
<td class="address-2"><span id="ca46"></span>CA46</td>
<td class="instruction">HALT</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca47"></span>CA47</td>
<td class="instruction">DJNZ <a href="C9B7.html#ca46">Progress_Halt_Loop</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca49"></span>CA49</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="asm-label">Phase</td>
<td class="address-1"><span id="ca4a"></span>CA4A</td>
<td class="instruction">DEFW $0006</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">Day</td>
<td class="address-1"><span id="ca4c"></span>CA4C</td>
<td class="instruction">DEFW $0001</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">Phase_Copy</td>
<td class="address-1"><span id="ca4e"></span>CA4E</td>
<td class="instruction">DEFM "PHASE"</td>
<td class="comment-1" rowspan="1">"PHASE".</td>
</tr>
<tr>
<td class="asm-label">Day_Copy</td>
<td class="address-1"><span id="ca53"></span>CA53</td>
<td class="instruction">DEFM " DAY "</td>
<td class="comment-1" rowspan="1">" DAY ".</td>
</tr>
<tr>
<td class="asm-label">Day_ASCII</td>
<td class="address-1"><span id="ca58"></span>CA58</td>
<td class="instruction">DEFM " 1"</td>
<td class="comment-1" rowspan="1">" 1".</td>
</tr>
<tr>
<td class="asm-label">Phase_ASCII</td>
<td class="address-1"><span id="ca5a"></span>CA5A</td>
<td class="instruction">DEFM " 6"</td>
<td class="comment-1" rowspan="1">" 6".</td>
</tr>
<tr>
<td class="asm-label">Progress_Buffer</td>
<td class="address-1"><span id="ca5c"></span>CA5C</td>
<td class="instruction">DEFM "PHASE 6",$FF</td>
<td class="comment-1" rowspan="1">This is a buffer - so text changes during play: "PHASE 6".</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ca64"></span>
<div class="comments">
<div class="paragraph">
Clears the screen and displays the day number.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Display_Day</td>
<td class="address-2"><span id="ca64"></span>CA64</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="2">Clears the screen by passing $00 to <a href="C9B7.html#c9d0">Clear_Screen</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca65"></span>CA65</td>
<td class="instruction">CALL <a href="C9B7.html#c9d0">Clear_Screen</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca68"></span>CA68</td>
<td class="instruction">CALL <a href="C9B7.html#c9fb">Display_Day</a></td>
<td class="comment-1" rowspan="1">Call <a href="C9B7.html#c9fb">Display_Day</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca6b"></span>CA6B</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ca6c"></span>
<div class="comments">
<div class="paragraph">
Clear down the day/ progress states.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Init_Progress</td>
<td class="address-2"><span id="ca6c"></span>CA6C</td>
<td class="instruction">LD HL,$0000</td>
<td class="comment-1" rowspan="3">Clears <a href="C9B7.html#ca4a">Phase</a> and <a href="C9B7.html#ca4c">Day</a> (writes $0000 to them).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca6f"></span>CA6F</td>
<td class="instruction">LD ($CA4A),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca72"></span>CA72</td>
<td class="instruction">LD ($CA4C),HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca75"></span>CA75</td>
<td class="instruction">LD A,$20</td>
<td class="comment-1" rowspan="6">Writes ASCII space ($20) to $CA61 and ASCII "0" ($30) to $CA62 (i.e. writes " 0" to the numeric portion of <a href="C9B7.html#ca5c">Progress_Buffer</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca77"></span>CA77</td>
<td class="instruction">LD HL,$CA61</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca7a"></span>CA7A</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca7b"></span>CA7B</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca7c"></span>CA7C</td>
<td class="instruction">LD A,$30</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca7e"></span>CA7E</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca7f"></span>CA7F</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="asm-label">Cashboxes_Completed_Flag</td>
<td class="address-1"><span id="ca80"></span>CA80</td>
<td class="instruction">DEFB $00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="ca81"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="C7E5.html">Init_Title_Screen</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Cashboxes_Completed</td>
<td class="address-2"><span id="ca81"></span>CA81</td>
<td class="instruction">CALL <a href="C9B7.html#cac8">Prep_Display_Phase_0</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca84"></span>CA84</td>
<td class="instruction">RET C</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca85"></span>CA85</td>
<td class="instruction">LD B,$10</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">Cashboxes_Flash_Loop</td>
<td class="address-2"><span id="ca87"></span>CA87</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca88"></span>CA88</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca89"></span>CA89</td>
<td class="instruction">AND $01</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca8b"></span>CA8B</td>
<td class="instruction">CALL <a href="C9B7.html#cab9">Deposit_Flash_Prep</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca8e"></span>CA8E</td>
<td class="instruction">LD B,$10</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca90"></span>CA90</td>
<td class="instruction">CALL <a href="CD64.html">Halt_Loop</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca93"></span>CA93</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca94"></span>CA94</td>
<td class="instruction">DJNZ <a href="C9B7.html#ca87">Cashboxes_Flash_Loop</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca96"></span>CA96</td>
<td class="instruction">LD B,$30</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca98"></span>CA98</td>
<td class="instruction">CALL <a href="CD64.html">Halt_Loop</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca9b"></span>CA9B</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca9c"></span>CA9C</td>
<td class="instruction">CALL <a href="C9B7.html#cab9">Deposit_Flash_Prep</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ca9f"></span>CA9F</td>
<td class="instruction">CALL <a href="D8B0.html">Random_Number</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caa2"></span>CAA2</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caa3"></span>CAA3</td>
<td class="instruction">LD A,R</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caa5"></span>CAA5</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caa6"></span>CAA6</td>
<td class="instruction">ADD A,B</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caa7"></span>CAA7</td>
<td class="instruction">LD D,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caa8"></span>CAA8</td>
<td class="instruction">LD A,($CBCF)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caab"></span>CAAB</td>
<td class="instruction">LD HL,$CBB4</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="caae"></span>CAAE</td>
<td class="instruction">CALL <a href="C3C0.html">$C3C0</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cab1"></span>CAB1</td>
<td class="instruction">LD ($CBCF),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cab4"></span>CAB4</td>
<td class="instruction">LD B,$00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cab6"></span>CAB6</td>
<td class="instruction">JP <a href="CD64.html">Halt_Loop</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">Deposit_Flash_Prep</td>
<td class="address-2"><span id="cab9"></span>CAB9</td>
<td class="instruction">LD HL,$CC8D</td>
<td class="comment-1" rowspan="5">Writes <span class="register">A</span> across all the deposit flags (copies to each from <a href="CC8D.html">DoorDeposited_01</a>).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cabc"></span>CABC</td>
<td class="instruction">LD DE,$CC8E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cabf"></span>CABF</td>
<td class="instruction">LD BC,$000D</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cac2"></span>CAC2</td>
<td class="instruction">LD (HL),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cac3"></span>CAC3</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cac5"></span>CAC5</td>
<td class="instruction">JP <a href="CC9B.html">$CC9B</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="CC9B.html">CC9B</a>.</td>
</tr>
<tr>
<td class="asm-label">Prep_Display_Phase_0</td>
<td class="address-2"><span id="cac8"></span>CAC8</td>
<td class="instruction">CALL <a href="C9B7.html#c9b7">Prep_Display_Phase</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="cacb"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routines at <a href="CD1B.html">Flash_Lives</a> and <a href="CD47.html">CD47</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Prep_Display_Phase_1</td>
<td class="address-2"><span id="cacb"></span>CACB</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="2">Writes $00 to <a href="D2D9.html#d2fe">D2FE</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cacc"></span>CACC</td>
<td class="instruction">LD ($D2FE),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cacf"></span>CACF</td>
<td class="instruction">CALL <a href="C9B7.html#cad4">Prep_Display_Phase_2</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cad2"></span>CAD2</td>
<td class="instruction">JR <a href="CAE7.html">$CAE7</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">Prep_Display_Phase_2</td>
<td class="address-2"><span id="cad4"></span>CAD4</td>
<td class="instruction">CALL <a href="CD68.html">Populate_Door_Buffer</a></td>
<td class="comment-1" rowspan="1">Call <a href="CD68.html">Populate_Door_Buffer</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cad7"></span>CAD7</td>
<td class="instruction">CALL <a href="CC3A.html">Draw_PlayWithDoors</a></td>
<td class="comment-1" rowspan="1">Call <a href="CC3A.html">Draw_PlayWithDoors</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cada"></span>CADA</td>
<td class="instruction">CALL <a href="CC5A.html">Life_Images</a></td>
<td class="comment-1" rowspan="1">Call <a href="CC5A.html">Life_Images</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cadd"></span>CADD</td>
<td class="instruction">CALL <a href="CC9B.html">$CC9B</a></td>
<td class="comment-1" rowspan="1">Call <a href="CC9B.html">CC9B</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cae0"></span>CAE0</td>
<td class="instruction">CALL <a href="CD90.html">Draw_Score</a></td>
<td class="comment-1" rowspan="1">Call <a href="CD90.html">Draw_Score</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cae3"></span>CAE3</td>
<td class="instruction">CALL <a href="D45E.html">ActiveDoors</a></td>
<td class="comment-1" rowspan="1">Call <a href="D45E.html">ActiveDoors</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="cae6"></span>CAE6</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="C959.html">C959</a>
</td>
<td class="up">Up: <a href="../maps/all.html#c9b7">Map</a></td>
<td class="next">
Next: <a href="CAE7.html">CAE7</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; DINAMIC SOFTWARE 1985 &copy; 2023 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.9.</div>
<div><a href="../dec/asm/51639.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>